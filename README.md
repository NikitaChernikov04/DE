# Система управления партнерами компании

## Описание проекта

Система для эффективного взаимодействия с партнерами и контроля их работы. Приложение обеспечивает обработку и хранение информации о партнерах в цифровом формате, управление продажами и расчет скидок.

## ER-диаграмма базы данных

Ниже представлена ER-диаграмма, отображающая структуру базы данных проекта:

![ER-диаграмма базы данных](docs/images/er_diagram.png)

![задания](docs/images/1.jpg)
![задания](docs/images/2.jpg)
![задания](docs/images/3.jpg)
![задания](docs/images/4.jpg)
![задания](docs/images/5.jpg)
![задания](docs/images/6.jpg)

Диаграмма отображает основные сущности системы и связи между ними:
- **Partner** - информация о партнерах компании
- **PartnerType** - типы партнеров
- **Product** - продукция компании
- **SalesHistory** - история продаж
- **Material** - материалы для производства продукции

## Функциональность

- **Управление партнерами:**
  - Просмотр списка партнеров
  - Добавление новых партнеров
  - Редактирование информации о партнерах

- **Управление типами партнеров:**
  - Просмотр списка типов
  - Добавление и редактирование типов

- **Управление продажами:**
  - Просмотр истории продаж каждого партнера
  - Добавление новых продаж
  - Автоматический расчет общей стоимости продажи

- **Система скидок:**
  - Автоматический расчет скидки на основе общей суммы продаж:
    - 0% при продажах до 10000 руб.
    - 5% при продажах от 10000 до 50000 руб.
    - 10% при продажах от 50000 до 300000 руб.
    - 15% при продажах более 300000 руб.

## Технологический стек

- **Backend:** Python 3, Flask
- **ORM:** SQLAlchemy
- **База данных:** PostgreSQL
- **Frontend:** HTML, CSS, JavaScript

## Структура проекта

- **app.py** - главный файл приложения, содержит маршруты и логику
- **models.py** - модели данных SQLAlchemy
- **db_schema.sql** - SQL-скрипт для создания схемы базы данных
- **templates/** - HTML-шаблоны
  - **partners.html** - список партнеров
  - **partner_form.html** - форма добавления/редактирования партнера
  - **sales_history.html** - история продаж партнера
  - **add_sale.html** - форма добавления продажи
  - **types.html** - список типов партнеров
  - **type_form.html** - форма добавления/редактирования типа
- **static/** - статические файлы
  - **style.css** - таблицы стилей

## Установка и запуск

### Предварительные требования

- Python 3.8+
- PostgreSQL

### Шаги установки

1. **Клонирование репозитория:**
   ```bash
   git clone <url-репозитория>
   cd <папка-проекта>
   ```

2. **Установка зависимостей:**
   ```bash
   pip install -r requirements.txt
   ```

3. **Создание базы данных PostgreSQL:**
   ```bash
   # Подключитесь к PostgreSQL
   psql -U postgres
   
   # Создайте базу данных
   CREATE DATABASE partners_db;
   
   # Выйдите из psql
   \q
   ```

4. **Настройка подключения к базе данных:**
   
   В файле `app.py` настройте параметры подключения к вашей базе данных:
   ```python
   app.config['SQLALCHEMY_DATABASE_URI'] = 'postgresql://postgres:postgres@localhost/partners_db'
   ```
   Замените `postgres:postgres` на ваши имя пользователя и пароль.

5. **Запуск приложения:**
   ```bash
   python app.py
   ```

6. **Доступ к приложению:**
   
   Откройте веб-браузер и перейдите по адресу [http://localhost:5000](http://localhost:5000)

## Первый запуск

При первом запуске приложение автоматически:
- Создаст необходимые таблицы в базе данных (если они еще не существуют)
- Добавит стандартные типы партнеров и тестовые продукты (только если таких данных еще нет)

**Примечание:** Приложение настроено для сохранения данных между запусками. Все добавленные партнеры, продажи и другие данные будут доступны при последующих запусках приложения.

После этого вы можете:
1. Добавить партнеров через веб-интерфейс
2. Добавить продажи для партнеров
3. Просматривать историю продаж и рассчитанные скидки 